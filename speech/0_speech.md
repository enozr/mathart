# 演讲

数字五年

--------------------------------- 客套话 ---------------------------------

大家晚上好 感谢任远大的邀请组织，ofcouse的宣传 在高大上的群里和大家聊聊专业。
对着手机自言自语，还不怎么适应 而且我的普通话不大好，有鼻音，希望大家包涵 
我回尽量把重点的文字列出来，这样大家查找也比较方便
我在阿里巴巴 阿里云 的可视化工程师，我们这里有个小团队 叫datav 专门做数据可视化
不知道大家有没有上datav.org看过 这是我们的网站。网站有点旧 现在正在上新版的  datav.org////////
我的方向主要是是webgl相关可视化、 地理相关可视化、大规模数据可视化。

大家阶段不同、专业不同，我怕自己的领域会过于狭隘。

所以除了海报提到的内容，我想简要增加这几年成长的经验体会，以及知识树的增长过程

<!-- 没有对电脑讲话的经历，声音也不美，就纯打字了，也好在qq和微信两个群里复制黏贴。

欢迎随时打断。 -->

--------------------------------- 源起 认识数字化 ---------------------------------

## 参数化的
我不知道大家知不知道一个叫做abbs的论坛   abbs/////
2008年年底，abbs上出了foral的帖子 
http://www.abbs.com.cn/bbs/blog/337106411.html
http://www.jtben.com/document/846619

那年foral是一个南加州大学的本科学生，却让向来苛刻的abbs大为轰动。我觉得时值今日这些文章也不过时，除了当时世界的一些先锋建筑的摘要，以及软件使用，更深刻的是算法、方法论、定义等认识。

推荐大家读一读。

2010年4月的一个晚上，我看到了这个帖子，于是我连续看了一星期foral的帖子和引的链接。我太感动了，迷茫的四年大学，我从没有一刻觉得自己找到了方向，而此刻如此坚定，我觉得未来就是搞数字化了，时隔五年也没有忘掉这种感觉。

当时我是景观设计师，工作将近一年，原本对自己的规划就是在设计院画很多年公园。

那年我开始学习Rhino和grasshopper 和 processing。

--------------------------------- processing 和小demo ---------------------------------

群里好多人，都是玩processing的，这几天将那时候的2个p5的demo翻译成了js版本 这样微信和浏览器都可以看了 这都非常简单。

大家可以用手指或鼠标点击屏幕看看。

第一个是用函数控制一群圆的绘制，只有一群圆，每个圆有2种空间属性，一个是离中心有多远（圆形xy坐标，但是用极坐标理解），一个是自己的半径有多大。第一种我让他符合指数函数的分布，第二种我让他符合幂次分布，又加了个三角函数干扰了下。最后上颜色。颜色是rgb值用三角函数算，各自有个相位差。

这是个代码原理上非常的简单的demo，源于一次不经意的实验，又在许多次调解参数的过程里不断修改，细节也忘了。

很难想象设计师可以把一万个圆画成这样，代码是一种新的可能，有些简单的感悟：

有些小感悟：
1、数学产生美，这种美可以如此有机。
2、短小的计算机程序可以产生极为复杂的形态，我们视觉对形状的理解，和计算机生成形状的方式，往往很不一样。

<!-- 纠结产生美，刚才说位置信息有2个函数，随着数字变大，一个的数值超过了另一个。我们的图形，正是一种矛盾超过另一个的过程。在这个短暂的平衡里，相互抗衡，形态精彩。 -->


这个连接 可以在手机和电脑运行 做过兼容了
http://hotu.co/blog/speech/speech_code/circle/


下一个demo是用树的算法改的（processing/范例程序/Topics/Fractals and L-Systems/tree）
树是一个很典型的分形形态，树的生长很好理解，分叉 生长 -> 分叉 生长 ->... 而长的早得树干会是小树枝的长度乘以一个系数。所以算法也很简单，就是到一个地方，算一个更短的长度，向左旋转画一条线，向右旋转画一条线，这个算法的实现有几种，但本质上差不多(processing里用的是递归，就是一个函数调用自己)。
为了更真实地去模拟树，还有些变体，比如，树枝按照概率被折断，树枝并不是直线，而是较为连续的贝塞尔线等，这样能模拟出非常真实的树，你甚至可以去三维空间搞。
但这个demo是另一个思路，我把旋转角度设成一堆函数，长度也设计成函数，颜色也随意乱变。分叉点有时候还画个圆，可结果很有意思，大家可以看看，有时候长的像真菌。

这个连接 可以在手机和电脑运行 做过兼容了
http://hotu.co/blog/speech/speech_code/tree/

--------------------------------- 分形世界 ---------------------------------
processing太慢，一个代码至少一晚上，有没有捷径？我渴望创造些思维定势外的东西。
10年下半年，我爱上了画分形。

http://v.youku.com/v_show/id_XMzM2MTE4MDQ0.html?from=y1.7-2

分形是什么？首先分形是一个大类，大到像是哲学，泛到没有一个学术化的定义。如果要穷其所有，维基百科搜索fractal就好。
我最喜欢的是逃逸时间分形，这个名字有点学霸范，更熟悉的可能是曼德勃罗集合和茱莉亚几何。这些都是可以精确定义的。
解释这种分形需要解释2个定义，一个是复变函数，一个是迭代，并不复杂，但不展开了，其实网上资料很多。
我们可以简单地理解为，输入一个函数，我就可以得到一幅图像，分形有些有趣的特点，比如可以无限放大。
其实分形的模式很固定，看你怎么选择函数、缩放等级和位置以及颜色对应关系。
所以分形软件也非常多，除了逃逸时间分形，还有IFS、 mandelblub(3d的)等，那时我用的是windows，最喜欢fractal expolerer，也试用过其他好多种分形软件 比如看这个详单 http://www.guokr.com/post/419383/
fractal expolerer的好处是可以自定义公式，而且比分形的定义更广泛一点，可以是把一个复数的实部和虚部拆开来自由地计算。
fractal的世界太美了，而你稍许调节一个参数，结果就完全不同地呈现出来了。就像一个变化万千的世界，用步移景异的光影将你的旅行塞满。
几乎有半年的时间，我回家每天都画着分形玩，睡觉前放几个计算量很大的分形继续渲染，第二天收图。


这个连接 可以在手机和电脑运行 要求是chrome等浏览器 手机的话 可能除了ios的新版本都不能访问
http://hotu.co/blog/speech/speech_code/fractal/

--------------------------------- 回到工作 ---------------------------------
回到工作上来，公司并不需要这些花花的东西，公司主要做公园。
我们是景观设计师，凳子亭子桥梁雕塑，这些都可以进行数字化设计。
这种数字化设计被概括成2类，
一是参数化设计，主要指的在方案阶段辅助设计些高B格的形体。
二是BIM 建筑信息一体化，大致指的在后期画施工图的时候统一管理，减少不必要的劳动。

我是做方案的，主要造型。此刻，该祭出大神器犀牛（Rhino）了， 这个做造型很牛逼。
Rhino首先是个建模软件， 虽然牛逼，也非市场垄断，直到有一天grasshopper出现了。
而grasshopper是个节点式编程的工具，grasshopper相当于Rhino的插件，通过节点式编程创造几何，功能强大，体验绝佳
这么多年，是我最爱的软件，没有之一。
节点式编程，俗称连电池，学名比较适合数据流类型的模块化编程，整个程序由一堆电池构成，每个电池都是个黑匣子，有输入有输出，中间过程你不用管（许多cg相关的软件都有类似的功能）

也许在座有人玩过vvvv 原理上差不多。

对于grasshopper而言，每个算法往往只是一个电池，一个电池背后的代码量也许是很大很大的，凝结着开源社区 -> Rhino公司 -> grasshopper开发者甚至到grasshopper插件开发者的智慧。

你也可以自己写电池，但除非性能非常关键或是功能实现不了，否则真的没必要。

群里可能玩互动的同学比较多，我也推荐试试grasshopper，至少grasshopper可以快速做原型， 大多情况比写任何代码快许多倍。

我身边的同事UED 也有用犀牛画logo的，因为犀牛的图形和操作命令更丰富

言归正传，从2010年到2012年，胡乱摸索，零碎地做了许多方案，列一个桥梁
双桥，只是为了好看，这点一定会有人驳斥。
先让总工大人在纸上肆意挥洒，勾出一个平面图，在rhino里描出来。
然后在每条线的基础上，生成一个桥梁的程序。高度用贝塞尔线控制，可以随意定下任一点的高度斜率满足两岸的高差
桥拱用指数函数控制，可以控制陡峭的程度满足通航。
然后，就是动一下曲线，桥梁全部重新生成了

又如这是上海青浦的一座桥，老板很喜欢。我就写了个程序 随意输入折线生成这种类型的桥。

除了构造物，景观需要堆山理水，梳理地形，这也可以参数化:
1、分析
这些是gis学的专长，高度分析、坡度分析、光照分析、视线分析。 给你个基地，这么一把弄，顿时高大上了。
我们从甲方那里得到的cad图纸，往往是三维点云，那在Rhino里，通过delauney mesh生成一张三角网格，然后通过切割曲面得到等高线，这些等高线又不光滑，于是需要通过曲线柔滑算法平滑一下，最后生成一堆面，染上颜色。


公司里有个同学画画很有感觉，总图填的很好，我拿他的图颜色一分析，就山寨了一个。

2、创造地形
给我们一个基地，如何画出一片地形？
很简单的一个想法就是用电场，电荷和电荷作用，会形成许多突起的等势面，待我一切割，就变成等高线啦。

可是你发现没 电荷的引力公式是 k * q1 * q2 / r^2 当两个电荷很近的时候，引力斥力接近无穷大，也就是等高线非常密。

而我们见到到部分山体的剖面，都接近s形的分布，先缓再陡再缓。

所以我在电荷的分布线上，加入了调整函数，去校正等高线的分布。这种校正很有意思，我们发现很多自然地形看起来是这样，往往是由一种特征曲线决定的(仅仅是形态上而已，山脉的形成和此无关)

但电场的方法并不实用，因为没有考虑到边界的地形信息，所以在最后，我发明了一种基于曲面细分的办法，这个效果还比较满意

grasshopper也能添加颜色，模拟些processing常见的算法，效率 
http://v.youku.com/v_show/id_XNTg2NDkwMzI4.html?from=s1.8-1-1.2

烟灰的大作 
http://mp.weixin.qq.com/s?__biz=MjM5MDEyNDE4MQ==&mid=208960403&idx=1&sn=c54c8504ab986e5a89b8e1c34f52a511&scene=1&srcid=09306OVkJoO3xmCUFWTmFhJx&key=2877d24f51fa53843bfac1805035c7c06b002b984d67172948403ffb6f5694df677388578d4391b4dac947e2028d5a50&ascene=0&uin=MjM4NzExMTIwMQ%3D%3D&devicetype=iMac+MacBookPro11%2C2+OSX+OSX+10.10.3+build(14D136)&version=11000006&pass_ticket=CyTU0f9Qj%2BrGP%2F8qfNtXuMa1cbjf0B5ODWdUX0e3dGr6ckOwmb7AwL2%2Btf3i%2FGCO

--------------------------------- 一点总结 ---------------------------------
鸟群算法、l-system、元细胞自动机、柏林噪音(perlin noise)、 delauney分割和voronoi分割、circle packing、IFS、逃逸时间分形..
有很多耳熟能详的算法，我们可以拿来去模拟漂亮地图形，这些图形时刻突破了我们的思维定势，随着参数的不同变异出千奇百怪的形态。

有些时候，某种算法看起来很智能，比如元细胞自动机，三大数学软件之一的mathematica创始人wolfram曾为此写过一本《一种新科学》，但在现实复杂的环境里，这种模拟也是极其粗糙的。

电脑还处于一种较为低级的状态，只是人类思维的辅助，总体上，只能偶尔地展现他的惊艳之处。

另外除了炫目的效果，更多时候，现实中我们需要控制，否则可能只是抽象画
所以在大量图形学算法里，只有一些很红火的，比如贝塞尔曲线 - 过n个点，我都可以画出一个光光的曲线，又如voronoi，我也不限制点的分布，随便你，来一个我画一种分割（这种分割是有意义的）。

2012年，我觉得有些迷茫，未来在哪里。


--------------------------------- 北京.建筑 ---------------------------------
2012年 上海到北京，源于一段视频，这是我前老板王振飞在贝尔拉格大学毕业的时候做的， 大家花5分钟时间看一看，很震撼。

http://www.tudou.com/programs/view/w6vc3RTefn0

前老板是一个非常务实的人，国内做参数化建筑，他也是最多的。

hhdfun一直用数学做设计，这种数字化是我最喜欢的。这并不是想到一个形态让后用数字模拟，而是去寻找一种经济实惠的数学系统，用在设计中。
为了让建筑让国内的施工队造出来，飞哥的建筑都是直线、圆弧构成的，有些重复的部件，都是尽可能地将开模成本降到最小，简而言之就是单元化
总之一句话，低成本下的好的设计，

在hhdfun 基本都是飞哥做设计，我们做深化实践。数字化到了施工阶段，也常常是无聊的事情，往往是分下幕墙、做楼梯、通风口、小雕塑，等等这些。

在这段时间，有一些有趣的研究。比如镶嵌相关的。
镶嵌的要义是用有限的单元去铺满一大片空间。
镶嵌是一们古老的艺术，镶嵌让我们想到马赛克，除了马赛克、中国古代的窗花、地砖、伊斯兰国家的清真寺，都遍布了这种重复性很高的单元
平面对称有17种模式，立体的镶嵌有300多种。但这种分类，是基于数学属性去分的。

从算法而言，我觉得生成镶嵌主要有2种办法
一类是堆砌，一种是分割 
堆砌的算法如 设置好一个单元，让他按照一定的规律进行排列，整好了可以填上某块空间，
分割的算法如切西瓜
但也有例外


在hhd-fun，我逐渐意识到建筑学和参数化设计是两回事，除了数字化设计，任何建筑设计公司都需要很好的建筑知识积累

在这一年，我

1、有些看起来复杂的事情 其实代码做很简单，有些看起来很简单 代码却很难 但深入设计一定是复杂的 有时很枯燥
2、建筑不仅仅追求美 美也未必用算法做
彭一刚 建筑是功能和形式 形式就是美学的功能
3、算法的深入有瓶颈 可能很难做到
老板说，这三年，自己在算法上没有什么突破。


grasshopper推荐烟灰和大川的 RHINOCEROS&GRASSHOPPER参数化建模 processing 推荐任远的 Processing互动编程 
http://book.douban.com/subject/6794408/
http://item.jd.com/11596853.html

eclipse 互动 

--------------------------------- 互联网公司  ---------------------------------
从软件界来到了互联网界，四年来，周围第一次变得和大学一样热闹。


在开始介绍工作前 我想听听大家是怎么理解数据可视化的
数据就是世界的缩略图 比如看这张表 
网站都是数据可视化

可能有3大类
图表类的，
图论的， 犯罪团伙之间的关联 交易关系的关联 等等 
地图类的 


我的第一个项目是
1、更加连续统一
网友的批评


我有几个感受
1、作为一个前端工程师，几乎是和算法无缘的，可视化工程师也很少，在接下来的2年里，我几乎和以前的学习说了声拜拜。
2、太tmd原始了，grasshopper里一小时搞定的形态，可能js要写个一星期。任何人的成功都是站在前人肩上的。
很奇怪的是工具的发展 比如flash
3、矛盾在增加 代码的高内聚、低耦合、绘制性能效率、网络传输的性能、可读性与命名规范、浏览器的兼容性 这个做建筑很像 美学的考虑只是一方面。
4、完美并不存在 更多的是委曲求全 在极限情况下，非常简单的事情变得复杂，
数据库的查询 海量数据的计算、 实时计算 流式计算 
以一个大家可能最了解的绘图为例，我们知道。                                                                     
5、大公司不应该是一条流水线，全栈工程师是一种基本的素质。
6、拆分拆分再拆分 怎样理解一件事情

走向炫酷所以应用3d，走向精细所以回到2d，

http://datavlab.org/heatmap2/


求婚
https://github.com/zhouningyi/openWedding
http://v.youku.com/v_show/id_XNzE3NDM1MzI0.html?from=y1.7-1.2
http://www.hotu.co/wedding/


只要有功夫，3d也能变得精细。

<!-- // -->
在这期间，做了些色彩研究
color3d.herokuapp.com


基本的地理观念

怎样画点图？


最后打两个广告 糊涂

怎样更平滑 如何降延时 





我相信美可以有两种分类，一种是复杂而华丽的美，巴洛克的建筑，拉赫玛尼诺夫的钢琴，一种是简单而本质的美，